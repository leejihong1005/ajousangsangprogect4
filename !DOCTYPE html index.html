<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>í‚¤ì˜¤ìŠ¤í¬ ì£¼ë¬¸ ì—°ìŠµ ê²Œì„</title>
  <style>
    body {
      font-family: 'Nanum Gothic', sans-serif;
      background-color: #fff8dc;
      padding: 20px;
      text-align: center;
    }
    h1 { font-size: 28px; color: #333; }
    button {
      font-size: 16px;
      padding: 10px;
      cursor: pointer;
    }
    .hidden { display: none; }
    .menu-box {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      justify-items: center;
      margin-top: 20px;
    }
    .menu-item {
      background-color: #fff;
      border: 2px solid #ccc;
      padding: 10px;
      border-radius: 10px;
      width: 150px;
    }
    .order-list, .mission-box {
      margin-top: 20px;
      font-size: 18px;
    }
    .order-item {
      background: #eee;
      padding: 10px;
      border-radius: 10px;
      margin: 5px auto;
      display: flex;
      justify-content: center;
      gap: 10px;
      align-items: center;
    }
    .qty-btn, .remove-btn {
      font-size: 18px;
      width: 30px;
      height: 30px;
      cursor: pointer;
    }
    .success { color: green; font-weight: bold; }
    .fail { color: red; font-weight: bold; }
  </style>
  <link href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css" rel="stylesheet">
</head>
<body>
  <h1>ğŸ” í‚¤ì˜¤ìŠ¤í¬ ì£¼ë¬¸ ê²Œì„</h1>
  <p class="mission-box" id="missionText"></p>

  <div id="start">
    <button onclick="startGame()">ê²Œì„ ì‹œì‘</button>
  </div>

  <div id="menuSection" class="hidden">
    <h2>ğŸ§¾ ë©”ë‰´ë¥¼ ì„ íƒí•˜ì„¸ìš”</h2>
    <div class="menu-box">
      <div class="menu-item"><button onclick="addItem('í–„ë²„ê±°', 5000)">í–„ë²„ê±° (â‚©5,000)</button></div>
      <div class="menu-item"><button onclick="addItem('ê°ìíŠ€ê¹€', 3000)">ê°ìíŠ€ê¹€ (â‚©3,000)</button></div>
      <div class="menu-item"><button onclick="addItem('ì½œë¼', 2000)">ì½œë¼ (â‚©2,000)</button></div>
      <div class="menu-item"><button onclick="addItem('í•«ë„ê·¸', 4000)">í•«ë„ê·¸ (â‚©4,000)</button></div>
      <div class="menu-item"><button onclick="addItem('ìƒˆìš°íŠ€ê¹€', 4000)">ìƒˆìš°íŠ€ê¹€ (â‚©4,000)</button></div>
      <div class="menu-item"><button onclick="addItem('ì•„ì´ìŠ¤ì»¤í”¼', 3500)">ì•„ì´ìŠ¤ì»¤í”¼ (â‚©3,500)</button></div>
      <div class="menu-item"><button onclick="addItem('ì¹˜ì¦ˆìŠ¤í‹±', 2500)">ì¹˜ì¦ˆìŠ¤í‹± (â‚©2,500)</button></div>
    </div>

    <div id="orderList"></div>
    <p id="totalPrice"></p>
    <button onclick="submitOrder()">ì£¼ë¬¸ ì™„ë£Œ</button>
  </div>

  <div id="paymentSection" class="hidden">
    <h2>ğŸ’³ ê²°ì œí•˜ê¸°</h2>
    <div id="paymentSummary"></div>
    <p>ê²°ì œ ìˆ˜ë‹¨ì„ ì„ íƒí•˜ì„¸ìš”:</p>
    <button onclick="submitPayment('ì¹´ë“œ')">ì¹´ë“œ ê²°ì œ</button>
    <button onclick="submitPayment('í˜„ê¸ˆ')">í˜„ê¸ˆ ê²°ì œ</button>
  </div>

  <div id="result" class="hidden"></div>

  <div id="restart" class="hidden">
    <button onclick="resetGame()">ë‹¤ì‹œ í•˜ê¸°</button>
  </div>

  <div id="home" class="hidden">
    <button onclick="goHome()">í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
  </div>

  <script>
    const allMenus = ['í–„ë²„ê±°','ê°ìíŠ€ê¹€','ì½œë¼','í•«ë„ê·¸','ìƒˆìš°íŠ€ê¹€','ì•„ì´ìŠ¤ì»¤í”¼','ì¹˜ì¦ˆìŠ¤í‹±'];
    let mission = [];
    let requiredPayment = '';
    let missionItems = [];
    let orderItems = [];
    let paymentMethod = '';

    function getRandomMenus(count) {
      const shuffled = [...allMenus].sort(() => 0.5 - Math.random());
      return shuffled.slice(0, count);
    }

    function startGame() {
      mission = getRandomMenus(3);
      missionItems = mission.map(item => ({ name: item, qty: Math.floor(Math.random() * 2) + 1 }));
      const missionText = missionItems.map(i => `${i.name} ${i.qty}ê°œ`).join(', ');
      requiredPayment = Math.random() < 0.5 ? 'ì¹´ë“œ' : 'í˜„ê¸ˆ';
      document.getElementById('missionText').innerText = `ğŸ¯ ë¯¸ì…˜: ${missionText} ì£¼ë¬¸í•˜ê³  ${requiredPayment}ë¡œ ê²°ì œí•˜ì„¸ìš”!`;
      document.getElementById('start').classList.add('hidden');
      document.getElementById('menuSection').classList.remove('hidden');
      document.getElementById('result').classList.add('hidden');
      document.getElementById('restart').classList.add('hidden');
      document.getElementById('home').classList.add('hidden');
      document.getElementById('paymentSection').classList.add('hidden');
      renderOrder();
    }

    function addItem(name, price) {
      const existing = orderItems.find(i => i.name === name);
      if (existing) existing.qty++;
      else orderItems.push({ name, price, qty: 1 });
      renderOrder();
    }

    function changeQty(index, delta) {
      const item = orderItems[index];
      item.qty += delta;
      if (item.qty <= 0) orderItems.splice(index, 1);
      renderOrder();
    }

    function removeItem(index) {
      orderItems.splice(index, 1);
      renderOrder();
    }

    function renderOrder() {
      const list = document.getElementById('orderList');
      list.innerHTML = '';
      let total = 0;
      orderItems.forEach((item, i) => {
        total += item.price * item.qty;
        const div = document.createElement('div');
        div.className = 'order-item';
        div.innerHTML = `${item.name} x ${item.qty} (â‚©${item.price})
          <button class="qty-btn" onclick="changeQty(${i}, 1)">+</button>
          <button class="qty-btn" onclick="changeQty(${i}, -1)">-</button>
          <button class="remove-btn" onclick="removeItem(${i})">X</button>`;
        list.appendChild(div);
      });
      document.getElementById('totalPrice').innerText = `ì´ ê¸ˆì•¡: â‚©${total.toLocaleString()}`;
    }

    function submitOrder() {
      if (orderItems.length === 0) {
        alert('ì£¼ë¬¸í•  ë©”ë‰´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
      }
      document.getElementById('menuSection').classList.add('hidden');
      renderSummary();
      document.getElementById('paymentSection').classList.remove('hidden');
    }

    function renderSummary() {
      const summary = document.getElementById('paymentSummary');
      let total = 0;
      const list = orderItems.map(i => {
        total += i.price * i.qty;
        return `<li>${i.name} x ${i.qty}ê°œ - â‚©${i.price * i.qty}</li>`;
      }).join('');
      summary.innerHTML = `<ul>${list}</ul><p><strong>ì´ ê²°ì œ ê¸ˆì•¡: â‚©${total.toLocaleString()}</strong></p>`;
    }

    function submitPayment(method) {
      paymentMethod = method;
      const selected = orderItems.map(i => ({ name: i.name, qty: i.qty })).sort((a, b) => a.name.localeCompare(b.name));
      const missionSorted = [...missionItems].sort((a, b) => a.name.localeCompare(b.name));
      const isCorrect = JSON.stringify(selected) === JSON.stringify(missionSorted);
      const result = document.getElementById('result');
      result.classList.remove('hidden');

      if (isCorrect && paymentMethod === requiredPayment) {
        result.innerHTML = `<p class="success">ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤! ì„±ê³µ! (${paymentMethod} ê²°ì œ)</p>`;
      } else {
        if (!isCorrect) {
          result.innerHTML = `<p class="fail">âŒ ì£¼ë¬¸ì´ ë¯¸ì…˜ê³¼ ë‹¤ë¦…ë‹ˆë‹¤. (${paymentMethod} ê²°ì œ)</p>`;
        } else {
          result.innerHTML = `<p class="fail">âŒ ê²°ì œ ë°©ì‹ì´ ë¯¸ì…˜ê³¼ ë‹¤ë¦…ë‹ˆë‹¤. ë¯¸ì…˜: ${requiredPayment}, ì„ íƒ: ${paymentMethod}</p>`;
        }
      }

      document.getElementById('restart').classList.remove('hidden');
      document.getElementById('home').classList.remove('hidden');
    }

    function resetGame() {
      document.getElementById('start').classList.remove('hidden');
      document.getElementById('menuSection').classList.add('hidden');
      document.getElementById('paymentSection').classList.add('hidden');
      document.getElementById('result').classList.add('hidden');
      document.getElementById('restart').classList.add('hidden');
      document.getElementById('home').classList.add('hidden');
      document.getElementById('orderList').innerHTML = '';
      document.getElementById('totalPrice').innerText = '';
      document.getElementById('missionText').innerText = '';
      document.getElementById('paymentSummary').innerHTML = '';
      orderItems = [];
      mission = [];
      missionItems = [];
      requiredPayment = '';
      paymentMethod = '';
    }

    function goHome() {
      document.getElementById('start').classList.remove('hidden');
      document.getElementById('menuSection').classList.add('hidden');
      document.getElementById('paymentSection').classList.add('hidden');
      document.getElementById('result').classList.add('hidden');
      document.getElementById('restart').classList.add('hidden');
      document.getElementById('home').classList.add('hidden');
      document.getElementById('orderList').innerHTML = '';
      document.getElementById('totalPrice').innerText = '';
      document.getElementById('missionText').innerText = '';
      document.getElementById('paymentSummary').innerHTML = '';
      orderItems = [];
      mission = [];
      missionItems = [];
      requiredPayment = '';
      paymentMethod = '';
    }
  </script>
</body>
</html>
